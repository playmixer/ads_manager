{% extends 'base.html' %}

{% block title %}manage{% endblock %}

{% block content %}
    <div class="row justify-content-md-center mb-5">
        <div>
            {% with title='Главная страница' %}
                {% include 'components/label_of_page.html' %}
            {% endwith %}
            {% with crumbs=[
                {'url': url_for('manage.index'), 'title': 'Главная страница'},
                {'url': url_for('manage.index'), 'title': 'Реклама'}
            ] %}
                {% include 'components/breadcrumbs.html' %}
            {% endwith %}
            <div style="width: 100%; height: 300px; display: flex; flex:1; justify-content: flex-end">
                {% include 'manage/chart/group_viewed_count_on_week.html' %}
            </div>
            <div class="row mb-5">
                <div class="col-6 col-md-3 col-sm-6">
                    {% with header='Показов за 24 часа', text=ads_viewed.get_viewed_24h().count() %}
                        {% include 'components/card.html' %}
                    {% endwith %}
                </div>
                <div class="col-6 col-md-3 col-sm-6">
                    {% with header='Показов за неделю', text=ads_viewed.get_viewed_7d().count() %}
                        {% include 'components/card.html' %}
                    {% endwith %}
                </div>
            </div>
            <table class="table table-striped table-hover">
                <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Название</th>
                    <th scope="col">Статус</th>
                    <th scope="col">Дата создания</th>
                    <th scope="col">За 24 ч.</th>
                    <th scope="col">За неделю</th>
                    <th width="10%"></th>
                </tr>
                </thead>
                <tbody>
                {% for group in group_list %}
                    <tr>
                        <th scope="row">{{ loop.index }}</th>
                        <td>
                            <a href="{{ url_for('manage.ads_group', group_id=group.id) }}" class="link-secondary">
                                {{ group.title }}
                            </a>
                        </td>
                        <td><span
                                class="{% if group.status.id == 0 %}text-danger{% else %}text-success{% endif %}">{{ group.status.title }}</span>
                        </td>
                        <td>{{ group.time_created|datetime('%d.%m.%Y') }}</td>
                        <td>{{ group.get_viewed_24h()|length }}</td>
                        <td>{{ group.get_viewed_7d()|length }}</td>
                        <td>
                            <a href="{{ url_for('manage.ads_group', group_id=group.id) }}" class="link-secondary">
                                перейти
                            </a>
                        </td>

                    </tr>
                {% endfor %}

                </tbody>
            </table>

        </div>
    </div>
    <form method="POST" action="{{ url_for('manage.ads_groups') }}">
        {{ form.csrf_token }}
        <div class="row justify-content-md-center">
            <div class="col-md-5">
                <h6>Создать новую группу</h6>
                <div class="mb-3" style="display: flex; flex-direction: row; align-items: center">
                    {{ form.title(size=20, class_='form-control', style='margin-right:5px', placeholder='Название') }}
                    <button type="submit" class="btn btn-primary">Создать</button>
                </div>

            </div>
        </div>
    </form>
{% endblock %}